<view class="page">
  <view class="container">
    <!-- é¦–æ¬¡åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading && (!commentsList || commentsList.length === 0)}}" class="loading-container">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- é”™è¯¯çŠ¶æ€ -->
    <view wx:elif="{{error && (!commentsList || commentsList.length === 0)}}" class="error-container">
      <text class="error-text">{{errorMessage || 'è·å–æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'}}</text>
      <button class="retry-btn" bindtap="retryLoad" size="mini" plain>é‡è¯•</button>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{!commentsList || commentsList.length === 0}}" class="empty-container">
      <text class="empty-text">æš‚æ— è¯„è®º</text>
    </view>

    <!-- è¯„è®ºåˆ—è¡¨ -->
    <view wx:else class="comments-list">
      <view 
        wx:for="{{commentsList}}" 
        wx:key="id"
        class="comment-card"
      >
        <view class="comment-content-wrapper" bindtap="viewArticleDetail" data-item="{{item.post || item}}">
          <text class="comment-post-title">{{item.post ? (item.post.title || item.post.name) : 'æ–‡ç« å·²åˆ é™¤'}}</text>
          <view class="comment-meta-row">
            <text class="comment-time">{{item.createdAt || item.created_at}}</text>
          </view>
          <view class="comment-text">{{item.content}}</view>
        </view>
        <view class="comment-actions">
          <view class="delete-btn" catchtap="deleteComment" data-comment="{{item}}">
            <text class="delete-icon">ğŸ—‘ï¸</text>
            <text class="delete-text">åˆ é™¤</text>
          </view>
        </view>
      </view>

      <!-- åŠ è½½æ›´å¤šæŒ‰é’®å’ŒåŠ è½½çŠ¶æ€ -->
      <view class="load-more-container">
        <view wx:if="{{loading && commentsList.length > 0}}" class="loading-more">
          <text class="loading-more-text">åŠ è½½ä¸­...</text>
        </view>
        <button 
          wx:elif="{{hasMore && !loading}}" 
          class="load-more-btn" 
          bindtap="loadMore" 
          size="mini" 
          plain
        >
          åŠ è½½æ›´å¤š
        </button>
        <view wx:elif="{{!hasMore && commentsList.length > 0}}" class="no-more">
          <text class="no-more-text">æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
      </view>
    </view>
  </view>
</view>

