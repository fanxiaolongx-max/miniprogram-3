<view class="page" data-weui-theme="light" style="width: 100%; overflow-x: hidden;">
  <view class="container">
    <!-- æ ¸å¿ƒå¡ç‰‡ -->
    <view class="main-card">
      <!-- æ±‡ç‡ä¿¡æ¯ -->
      <view class="exchange-rate-info">
        <view wx:if="{{rateLoading}}" class="rate-loading">
          <text class="rate-text">æ­£åœ¨åŠ è½½æ±‡ç‡...</text>
        </view>
        <block wx:else>
          <view class="rate-header">
            <text class="rate-text">
              <text wx:if="{{!isReversed}}">1 CNY = {{exchangeRate}} EGP</text>
              <text wx:else>1 EGP = {{reverseRate}} CNY</text>
            </text>
            <text class="rate-update" bindtap="updateRate">æ›´æ–°</text>
          </view>
          <text wx:if="{{lastUpdated}}" class="rate-time">{{lastUpdated}}</text>
        </block>
      </view>
      
      <!-- è¾“å…¥/è¾“å‡ºåŒºåŸŸ -->
      <view class="input-section">
        <!-- ä¸Šæ–¹è´§å¸ï¼ˆæ ¹æ®isReversedæ¡ä»¶æ¸²æŸ“ï¼‰ -->
        <view wx:if="{{!isReversed}}" class="currency-row currency-row-top">
          <view class="currency-info">
            <text>ğŸ‡¨ğŸ‡³</text>
            <text class="currency-code">CNY</text>
          </view>
          <view class="currency-amount-wrapper">
            <text class="currency-symbol">Â¥</text>
            <input 
              class="currency-amount" 
              type="digit" 
              placeholder="0.00"
              value="{{cnyAmount}}"
              bindinput="onCNYInput"
            />
          </view>
        </view>
        <view wx:else class="currency-row currency-row-top">
          <view class="currency-info">
            <text>ğŸ‡ªğŸ‡¬</text>
            <text class="currency-code">EGP</text>
          </view>
          <view class="currency-amount-wrapper">
            <text class="currency-symbol">EÂ£</text>
            <input 
              class="currency-amount" 
              type="digit" 
              placeholder="0.00"
              value="{{egpAmount}}"
              bindinput="onEGPInput"
            />
          </view>
        </view>
        
        <!-- åˆ‡æ¢æŒ‰é’® -->
        <view class="switch-button" bindtap="toggleDirection">
          <text class="switch-icon">â‡…</text>
        </view>
        
        <!-- ä¸‹æ–¹è´§å¸ï¼ˆæ ¹æ®isReversedæ¡ä»¶æ¸²æŸ“ï¼Œæ”¯æŒè¾“å…¥ï¼‰ -->
        <view wx:if="{{!isReversed}}" class="currency-row currency-row-bottom">
          <view class="currency-info">
            <text>ğŸ‡ªğŸ‡¬</text>
            <text class="currency-code">EGP</text>
          </view>
          <view class="currency-amount-wrapper">
            <text class="currency-symbol">EÂ£</text>
            <input 
              class="currency-amount" 
              type="digit" 
              placeholder="0.00"
              value="{{egpAmount}}"
              bindinput="onEGPInput"
            />
          </view>
        </view>
        <view wx:else class="currency-row currency-row-bottom">
          <view class="currency-info">
            <text>ğŸ‡¨ğŸ‡³</text>
            <text class="currency-code">CNY</text>
          </view>
          <view class="currency-amount-wrapper">
            <text class="currency-symbol">Â¥</text>
            <input 
              class="currency-amount" 
              type="digit" 
              placeholder="0.00"
              value="{{cnyAmount}}"
              bindinput="onCNYInput"
            />
          </view>
        </view>

        <!-- è´­ä¹°åŠ›å‚è€ƒ -->
        <view wx:if="{{purchasingPower}}" class="purchasing-power">
          <text class="power-text">{{purchasingPower}}</text>
        </view>
      </view>
    </view>

    <!-- æ±‡ç‡çœ‹æ¿åˆ—è¡¨ -->
    <view wx:if="{{safeOtherCurrencies && safeOtherCurrencies.length > 0}}" class="rate-board">
      <view class="board-title">å…¶ä»–è´§å¸å‚è€ƒ</view>
      <view class="currency-list">
        <block wx:for="{{safeOtherCurrencies}}" wx:key="index" wx:for-item="item" wx:for-index="index">
          <view wx:if="{{item && item.code && item.name && item.flag && item.symbol && item.amount}}" class="currency-card">
            <view class="card-left">
              <text class="card-flag">{{item.flag || ''}}</text>
              <text class="card-name">{{item.name || ''}}</text>
              <text class="card-code">{{item.code || ''}}</text>
            </view>
            <view class="card-right">
              <text class="card-symbol">{{item.symbol || ''}}</text>
              <text class="card-amount">{{item.amount || '0.00'}}</text>
            </view>
          </view>
        </block>
      </view>
    </view>
    
    <!-- å¤±è´¥æç¤ºï¼ˆç‹¬ç«‹æ˜¾ç¤ºï¼‰ -->
    <view wx:if="{{failedCurrenciesText && failedCurrenciesText !== ''}}" class="rate-board">
      <view class="failed-hint">
        <text class="failed-text">ä»¥ä¸‹è´§å¸æ±‡ç‡è·å–å¤±è´¥ï¼Œæœªå‚ä¸è®¡ç®—ï¼š{{failedCurrenciesText}}</text>
      </view>
    </view>

  </view>
</view>

