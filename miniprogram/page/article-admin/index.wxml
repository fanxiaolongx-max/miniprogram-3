<view class="page" data-weui-theme="light" style="width: 100%; overflow-x: hidden;">
  <view class="container">
    <!-- é¡¶éƒ¨æ“ä½œæ  -->
    <view class="header-section">
      <view class="header-title">æ–‡ç« ç®¡ç†</view>
      <view class="header-actions">
        <view class="add-btn" bindtap="createArticle">
          <text class="add-icon">â•</text>
          <text class="add-text">æ–°å»º</text>
        </view>
      </view>
    </view>

    <!-- æœç´¢åŒºåŸŸ -->
    <view class="filter-section">
      <view class="search-box">
        <input 
          class="search-input"
          placeholder="æœç´¢æ–‡ç« ..."
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
        />
        <text class="search-icon">ğŸ”</text>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-container">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- é”™è¯¯çŠ¶æ€ -->
    <view wx:elif="{{error}}" class="error-container">
      <text class="error-text">{{errorMessage || 'è·å–æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'}}</text>
      <button class="retry-btn" bindtap="retry">é‡è¯•</button>
    </view>

    <!-- ç€‘å¸ƒæµåˆ—è¡¨ -->
    <block wx:else>
      <view wx:if="{{filteredItems.length === 0}}" class="empty-container">
        <text class="empty-text">æš‚æ— æ–‡ç« </text>
        <view class="empty-action">
          <button class="create-btn" bindtap="createArticle">åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡ç« </button>
        </view>
      </view>
      <view wx:else class="waterfall-container">
        <view class="waterfall-column">
          <view 
            wx:for="{{filteredItems}}" 
            wx:key="id"
            wx:for-item="item"
            wx:for-index="index"
            wx:if="{{index % 2 === 0}}"
            class="waterfall-item"
          >
            <view class="item-image-wrapper">
              <image 
                class="item-image" 
                src="{{item.image}}" 
                mode="aspectFill"
                binderror="onImageError"
                bindtap="viewDetail"
                data-item="{{item}}"
              ></image>
              <view wx:if="{{!item.published}}" class="draft-badge">è‰ç¨¿</view>
            </view>
            <view class="item-content">
              <view class="item-title" bindtap="viewDetail" data-item="{{item}}">{{item.name}}</view>
              <view wx:if="{{item.description}}" class="item-description">{{item.description}}</view>
              <view wx:if="{{item.category}}" class="item-category">{{item.category}}</view>
              <view class="item-footer">
                <text class="item-date">{{item.createdAt}}</text>
                <view class="item-actions">
                  <view class="action-btn edit-btn" catchtap="editArticle" data-item="{{item}}">
                    <text>âœï¸</text>
                  </view>
                  <view class="action-btn delete-btn" catchtap="deleteArticle" data-item="{{item}}">
                    <text>ğŸ—‘ï¸</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
        <view class="waterfall-column">
          <view 
            wx:for="{{filteredItems}}" 
            wx:key="id"
            wx:for-item="item"
            wx:for-index="index"
            wx:if="{{index % 2 === 1}}"
            class="waterfall-item"
          >
            <view class="item-image-wrapper">
              <image 
                class="item-image" 
                src="{{item.image}}" 
                mode="aspectFill"
                binderror="onImageError"
                bindtap="viewDetail"
                data-item="{{item}}"
              ></image>
              <view wx:if="{{!item.published}}" class="draft-badge">è‰ç¨¿</view>
            </view>
            <view class="item-content">
              <view class="item-title" bindtap="viewDetail" data-item="{{item}}">{{item.name}}</view>
              <view wx:if="{{item.description}}" class="item-description">{{item.description}}</view>
              <view wx:if="{{item.category}}" class="item-category">{{item.category}}</view>
              <view class="item-footer">
                <text class="item-date">{{item.createdAt}}</text>
                <view class="item-actions">
                  <view class="action-btn edit-btn" catchtap="editArticle" data-item="{{item}}">
                    <text>âœï¸</text>
                  </view>
                  <view class="action-btn delete-btn" catchtap="deleteArticle" data-item="{{item}}">
                    <text>ğŸ—‘ï¸</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
      <!-- åŠ è½½æ›´å¤šæŒ‰é’® -->
      <view wx:if="{{hasMore && !loadingMore && !preloading && !loading}}" class="load-more-container">
        <text class="load-more-btn" bindtap="loadMore">åŠ è½½æ›´å¤š</text>
      </view>
      <!-- åŠ è½½ä¸­æç¤º -->
      <view wx:if="{{loadingMore || preloading}}" class="loading-more">
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>
      <!-- æ²¡æœ‰æ›´å¤šæç¤º -->
      <view wx:if="{{!hasMore && items.length > 0}}" class="no-more">
        <text class="no-more-text">æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
      </view>
    </block>
  </view>
</view>

