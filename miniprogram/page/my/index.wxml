<view class="page" data-weui-theme="light">
  <view class="container">
    <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <view class="user-section">
      <block wx:if="{{hasUserInfo === true}}">
        <image class="userinfo-avatar" src="{{userInfo.avatarUrl}}"></image>
        <text class="userinfo-nickname">{{userInfo.nickName}}</text>
      </block>
      <block wx:else>
        <view class="user-placeholder">
          <text class="user-placeholder-text">æœªç™»å½•</text>
        </view>
      </block>
    </view>

    <!-- è·å–ç”¨æˆ·ä¿¡æ¯æŒ‰é’®åŒºåŸŸ -->
    <view class="btn-section">
      <block wx:if="{{hasUserInfo === false}}">
        <button wx:if="{{canIUseGetUserProfile}}" type="primary" bindtap="handleGetUserProfile">ç™»å½•</button>
        <button wx:else type="primary" open-type="getUserInfo" bindgetuserinfo="getUserInfo">ç™»å½•</button>
      </block>
      <block wx:else>
        <text class="status-text">å·²è·å–ç”¨æˆ·ä¿¡æ¯</text>
      </block>
    </view>

    <!-- åé¦ˆå»ºè®®åŒºåŸŸ -->
    <view class="feedback-section">
      <view class="feedback-title">ğŸ“ åé¦ˆå»ºè®®</view>
      <view class="feedback-card">
        <view class="feedback-form">
          <!-- åŠŸèƒ½åˆ†ç±»é€‰æ‹© -->
          <view class="form-item">
            <view class="form-label">åŠŸèƒ½åˆ†ç±»ï¼ˆå¯é€‰ï¼‰</view>
            <picker 
              mode="selector" 
              range="{{feedbackCategories}}" 
              range-key="label"
              value="{{feedbackCategoryIndex}}"
              bindchange="onCategoryChange"
            >
              <view class="picker-view">
                {{feedbackCategory || 'è¯·é€‰æ‹©åŠŸèƒ½åˆ†ç±»'}}
                <text class="picker-arrow">â–¼</text>
              </view>
            </picker>
          </view>

          <!-- åé¦ˆå†…å®¹è¾“å…¥ -->
          <view class="form-item">
            <view class="form-label">åé¦ˆå†…å®¹</view>
            <textarea 
              class="feedback-textarea"
              placeholder="è¯·è¾“å…¥æ‚¨çš„åé¦ˆã€å»ºè®®æˆ–éœ€æ±‚ï¼ˆ5-500å­—ï¼‰"
              value="{{feedbackContent}}"
              bindinput="onFeedbackInput"
              maxlength="500"
              show-confirm-bar="{{false}}"
            ></textarea>
            <view class="char-count">{{feedbackContent.length}}/500</view>
          </view>

          <!-- æäº¤æŒ‰é’® -->
          <button 
            class="submit-btn" 
            type="primary" 
            bindtap="submitFeedback"
            disabled="{{submitting}}"
            loading="{{submitting}}"
          >
            {{submitting ? 'æäº¤ä¸­...' : 'æäº¤åé¦ˆ'}}
          </button>
        </view>
      </view>
    </view>
  </view>
</view>

