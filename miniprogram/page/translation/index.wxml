<view class="page" data-weui-theme="light">
  <view class="container">
    <view class="translation-section">
      <!-- åˆ†ç±»ç­›é€‰ -->
      <view class="category-filter">
        <view 
          wx:for="{{categories}}" 
          wx:key="*this"
          class="category-item {{selectedCategory === item ? 'active' : ''}}"
          bindtap="selectCategory"
          data-category="{{item}}"
        >
          {{item === 'all' ? 'å…¨éƒ¨' : item}}
        </view>
      </view>

      <!-- åŠ è½½çŠ¶æ€ -->
      <view wx:if="{{loading}}" class="loading-container">
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>

      <!-- é”™è¯¯çŠ¶æ€ -->
      <view wx:elif="{{error}}" class="error-container">
        <text class="error-text">è·å–æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</text>
        <button class="retry-btn" bindtap="retry">é‡è¯•</button>
      </view>

      <!-- å¤§è‰²å—çŸ©é˜µå¸ƒå±€ -->
      <block wx:else>
        <view wx:if="{{phrases.length === 0}}" class="empty-container">
          <text class="empty-text">æš‚æ— ç¿»è¯‘æ•°æ®</text>
        </view>
        <view wx:else class="phrase-grid">
          <view 
            wx:for="{{phrases}}" 
            wx:key="id"
            wx:for-item="phrase"
            class="phrase-button {{selectedCategory !== 'all' && phrase.category !== selectedCategory ? 'hidden' : ''}}"
            bindtap="showPhrase"
            data-phrase="{{phrase}}"
          >
            <view class="phrase-button-text">{{phrase.chinese}}</view>
            <view class="phrase-button-category">{{phrase.category}}</view>
          </view>
        </view>
      </block>
    </view>

    <!-- å…¨å±æ˜¾ç¤ºå¼¹çª— -->
    <view wx:if="{{showModal}}" class="phrase-modal" bindtap="hidePhrase">
      <view class="modal-content" catchtap="stopPropagation">
        <view class="modal-header">
          <text class="modal-title">{{currentPhrase.chinese}}</text>
          <text class="modal-close" bindtap="hidePhrase">âœ•</text>
        </view>
        <view class="modal-body">
          <view class="modal-text-container">
            <view class="modal-chinese {{playingLang === 'zh' && isPlaying ? 'playing' : ''}}" bindtap="speakChinese" data-text="{{currentPhrase.chinese}}">
              <text class="text-content">{{currentPhrase.chinese}}</text>
              <text class="speak-icon">{{playingLang === 'zh' && isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}}</text>
            </view>
            <view class="modal-arabic {{playingLang === 'ar' && isPlaying ? 'playing' : ''}}" bindtap="speakArabic" data-text="{{currentPhrase.arabic}}">
              <text class="text-content">{{currentPhrase.arabic}}</text>
              <text class="speak-icon">{{playingLang === 'ar' && isPlaying ? 'â¸ï¸' : 'ğŸ”Š'}}</text>
            </view>
          </view>
          <view class="modal-actions">
            <button class="action-btn" bindtap="copyArabic" data-text="{{currentPhrase.arabic}}">å¤åˆ¶é˜¿è¯­</button>
            <button class="action-btn" bindtap="copyChinese" data-text="{{currentPhrase.chinese}}">å¤åˆ¶ä¸­æ–‡</button>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

